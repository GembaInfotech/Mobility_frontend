"use strict";(self.webpackChunknasp=self.webpackChunknasp||[]).push([[5409],{9494:function(e,t,n){n.d(t,{EY:function(){return u},Fv:function(){return l},ac:function(){return s}});var a=n(74165),i=n(15861),r=n(91181),o=n(14712);function s(e,t){return o.Z.get(e,{params:t}).then((function(e){return null===e||void 0===e?void 0:e.data}))}function l(e,t){return o.Z.post(e,t).then((function(e){return null===e||void 0===e?void 0:e.data}))}function u(e){return c.apply(this,arguments)}function c(){return(c=(0,i.Z)((0,a.Z)().mark((function e(t){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r.Z.fetchData({url:"/search/query",method:"post",data:t}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},55409:function(e,t,n){n.r(t);var a=n(29439),i=n(72791),r=n(92506),o=n(62797),s=n(57689),l=n(16146),u=n(78820),c=n(9494),d=n(11723),f=n(52639),p=n(80184),v=o.Ry().shape({code:o.Z_().required("L Code is required"),stockType:o.Ry().required("Stock Entry Type is required"),quantity:o.Rx().required("Quantity is required").positive("Quantity must be positive").integer("Quantity must be an integer"),location:o.Z_().required("Location is required")}),h={code:"",description:"",stockType:{label:"Material Receipt",value:1},quantity:"",location:"",uom:"",uomId:"",transferLocation:"",transferQuantity:""};t.default=function(e){e.onClose,e.refreshPage;var t,n=(0,s.UO)().id,o=(0,i.useState)(!1),y=(0,a.Z)(o,2),m=y[0],x=(y[1],(0,i.useState)([])),T=(0,a.Z)(x,2),j=T[0],b=T[1],g=(0,i.useState)([]),k=(0,a.Z)(g,2),S=k[0],I=k[1],q=(0,i.useState)(h),L=(0,a.Z)(q,2),A=L[0],_=L[1],C=(0,i.useState)(!0),D=(0,a.Z)(C,2),Q=D[0],Z=D[1],E=(0,s.s0)(),M=(0,s.TH)();(0,i.useEffect)((function(){if((0,c.ac)(d.vh.LIST_DATA,{type:d.kD.CODES}).then((function(e){if(e&&e.data&&Array.isArray(e.data.data)){var t=e.data.data.filter((function(e){return 1===e.type})).map((function(e){var t,n;return{label:e.code,value:e._id,description:e.description,uom:null===e||void 0===e||null===(t=e.uomId)||void 0===t?void 0:t.name,uomId:null===e||void 0===e||null===(n=e.uomId)||void 0===n?void 0:n._id}}));b(t),Z(!1)}else l.Am.push((0,p.jsx)(l.P_,{type:"error",children:"No Materials found!"}))})).catch((function(e){console.error("Error fetching materials:",e),l.Am.push((0,p.jsx)(l.P_,{type:"error",children:"Failed to load Materials"}))})),(0,c.ac)(d.vh.LIST_DATA,{type:d.kD.LOCATIONS}).then((function(e){if(e&&e.data&&Array.isArray(e.data.data)){var t=e.data.data.map((function(e){return{label:e.name,value:e._id}}));I(t)}else l.Am.push((0,p.jsx)(l.P_,{type:"error",children:"No Warehouses found!"}))})).catch((function(e){console.error("Error fetching warehouses:",e),l.Am.push((0,p.jsx)(l.P_,{type:"error",children:"Failed to load Warehouses"}))})),n){var e,t,a,i,r=null===(e=M.state)||void 0===e?void 0:e.editData;_({code:(null===r||void 0===r||null===(t=r.lcodeId)||void 0===t?void 0:t._id)||"",description:(null===(a=r.lcodeId)||void 0===a?void 0:a.description)||"",stockType:{label:"Material Receipt",value:1},quantity:r.quantity||"",location:(null===(i=r.locationId)||void 0===i?void 0:i._id)||"",modelType:d.kD.STOCK_ENTRY})}}),[n,null===(t=M.state)||void 0===t?void 0:t.editData]);return(0,p.jsx)(r.J9,{initialValues:A,validationSchema:v,onSubmit:function(e,t){var a,i=t.setSubmitting,r={lcodeId:e.code,stockType:null===(a=e.stockType)||void 0===a?void 0:a.value,quantity:e.quantity,locationId:e.location,uomId:e.uomId,transferLocation:e.transferLocation,transferQuantity:e.transferQuantity,modelType:d.kD.STOCK_ENTRY};n&&(r.id=n),(0,c.Fv)(d.vh.ADD_EDIT_DATA,r).then((function(e){l.Am.push((0,p.jsx)(l.P_,{type:"success",children:n?f.D5:f.Te})),E("/app/inventory/stockEntry")})).catch((function(e){l.Am.push((0,p.jsx)(l.P_,{type:"error",children:e}))})).finally((function(){i(!1)}))},enableReinitialize:!0,children:function(e){var t=e.errors,n=e.touched,a=e.values,i=e.setFieldValue,o=e.isSubmitting;return(0,p.jsxs)(r.l0,{children:[(0,p.jsxs)("div",{className:"flex mb-3 justify-between w-3/4",children:[(0,p.jsx)("h3",{children:A.code?"Edit Stock":"Add Stock"}),(0,p.jsxs)("div",{className:"flex",children:[(0,p.jsx)(l.zx,{size:"sm",className:"ltr:mr-3 rtl:ml-3",onClick:function(){return E(-1)},icon:(0,p.jsx)(u.SV5,{}),type:"button",children:"Cancel"}),(0,p.jsx)(l.zx,{size:"sm",variant:"solid",loading:o||m,icon:(0,p.jsx)(u.JMf,{}),type:"submit",children:A.code?"Update":"Save"})]})]}),(0,p.jsx)(l.Zb,{className:"mt-2.5 w-3/4",children:(0,p.jsxs)(l.Yb,{className:"md:w-full lg:w-1/2",children:[(0,p.jsx)(l.xJ,{label:"Stock Entry Type",invalid:t.stockType&&n.stockType,errorMessage:t.stockType,children:(0,p.jsx)(l.Ph,{name:"stockType",options:[{label:"Material Receipt",value:1},{label:"Material Transfer",value:2}],placeholder:"Select Stock Type",value:a.stockType,onChange:function(e){return i("stockType",e)}})}),(0,p.jsx)(l.xJ,{label:"Location",invalid:t.location&&n.location,errorMessage:t.location,children:(0,p.jsx)(l.Ph,{name:"location",options:S,placeholder:"Select Location",value:S.find((function(e){return e.value===a.location})),onChange:function(e){return i("location",e.value)}})}),(0,p.jsx)(l.xJ,{label:"LCode",invalid:t.code&&n.code,errorMessage:t.code,children:Q?(0,p.jsx)(l.II,{size:"sm",value:"Loading...",readOnly:!0}):(0,p.jsx)(l.Ph,{size:"sm",name:"code",placeholder:"Select LCode",options:j,value:j.find((function(e){return e.value===a.code}))||null,onChange:function(e){i("code",e.value),i("description",e.description),i("uom",e.uom),i("uomId",e.uomId)}})}),(0,p.jsx)(l.xJ,{label:"Description",children:(0,p.jsx)(r.gN,{as:l.II,size:"sm",name:"description",value:a.description,readOnly:!0})}),(0,p.jsx)(l.xJ,{label:"Quantity",invalid:t.quantity&&n.quantity,errorMessage:t.quantity,children:(0,p.jsx)(r.gN,{as:l.II,type:"number",name:"quantity",placeholder:"Add Quantity",value:a.quantity,onChange:function(e){return i("quantity",e.target.value)}})}),2===a.stockType.value&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(l.xJ,{label:"Transfer Location",invalid:t.transferLocation&&n.transferLocation,errorMessage:t.transferLocation,children:(0,p.jsx)(l.Ph,{name:"transferLocation",options:S,placeholder:"Select Transfer Location",value:S.find((function(e){return e.value===a.transferLocation})),onChange:function(e){return i("transferLocation",e.value)}})}),(0,p.jsx)(l.xJ,{label:"Transfer Quantity",invalid:t.transferQuantity&&n.transferQuantity,errorMessage:t.transferQuantity,children:(0,p.jsx)(r.gN,{as:l.II,type:"number",name:"transferQuantity",placeholder:"Enter Transfer Quantity",value:a.transferQuantity,onChange:function(e){return i("transferQuantity",e.target.value)}})})]})]})})]})}})}}}]);
//# sourceMappingURL=5409.5dfac0a7.chunk.js.map