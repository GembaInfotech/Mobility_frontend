"use strict";(self.webpackChunknasp=self.webpackChunknasp||[]).push([[5409],{9494:function(e,a,t){t.d(a,{EY:function(){return s},Fv:function(){return l},ac:function(){return u}});var r=t(74165),n=t(15861),i=t(91181),o=t(14712);function u(e,a){return o.Z.get(e,{params:a}).then((function(e){return null===e||void 0===e?void 0:e.data}))}function l(e,a){return o.Z.post(e,a).then((function(e){return null===e||void 0===e?void 0:e.data}))}function s(e){return c.apply(this,arguments)}function c(){return(c=(0,n.Z)((0,r.Z)().mark((function e(a){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",i.Z.fetchData({url:"/search/query",method:"post",data:a}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},55409:function(e,a,t){t.r(a);var r=t(29439),n=t(72791),i=t(92506),o=t(62797),u=t(16146),l=t(78820),s=t(9494),c=t(11723),d=t(57689),v=t(80184),m=o.Ry().shape({materialNo:o.Z_().required("Material Code is required"),stockType:o.Ry().required("Stock Entry Type is required"),quantity:o.Rx().required("Quantity is required").positive("Quantity must be positive").integer("Quantity must be an integer"),sourceWareHouse:o.Z_().required("Source Warehouse is required"),targetWareHouse:o.Z_().when("stockType",{is:function(e){return 2===e.value},then:o.Z_().required("Target Warehouse is required")})}),h={materialNo:"",materialName:"",stockType:"",quantity:"",sourceWareHouse:"",targetWareHouse:"",availableQuantity:""};a.default=function(e){e.onClose,e.refreshPage;var a,t=(0,n.useState)(!1),o=(0,r.Z)(t,2),y=(o[0],o[1]),p=(0,n.useState)([]),f=(0,r.Z)(p,2),x=f[0],g=f[1],b=(0,n.useState)([]),j=(0,r.Z)(b,2),N=j[0],T=j[1],S=(0,n.useState)([]),W=(0,r.Z)(S,2),k=W[0],A=W[1],I=(0,n.useState)({}),H=(0,r.Z)(I,2),q=H[0],_=(H[1],(0,n.useState)(h)),Z=(0,r.Z)(_,2),M=Z[0],C=Z[1],D=(0,d.s0)(),Q=(0,d.TH)();(0,n.useEffect)((function(){var e;null!==(e=Q.state)&&void 0!==e&&e.editData&&C(Q.state.editData),(0,s.ac)(c.vh.LIST_DATA,{type:c.kD.MATERIALS}).then((function(e){if(e&&e.data&&Array.isArray(e.data.data)){var a=e.data.data.map((function(e){var a,t;return{label:e.materialNo,value:e._id,materialName:e.material,uom:null===e||void 0===e||null===(a=e.uomId)||void 0===a?void 0:a.name,uomId:null===e||void 0===e||null===(t=e.uomId)||void 0===t?void 0:t._id}}));console.log(a),g(a)}else u.Am.push((0,v.jsx)(u.P_,{type:"error",children:"No Materials found!"}))})).catch((function(e){console.error("Error fetching materials:",e),u.Am.push((0,v.jsx)(u.P_,{type:"error",children:"Failed to load Materials"}))})),(0,s.ac)(c.vh.LIST_DATA,{type:c.kD.INVLOCATION}).then((function(e){if(e&&e.data&&Array.isArray(e.data.data)){var a=e.data.data.map((function(e){return{label:e.name,value:e._id}}));T(a),A(a)}else u.Am.push((0,v.jsx)(u.P_,{type:"error",children:"No Warehouses found!"}))})).catch((function(e){console.error("Error fetching warehouses:",e),u.Am.push((0,v.jsx)(u.P_,{type:"error",children:"Failed to load Warehouses"}))}))}),[null===(a=Q.state)||void 0===a?void 0:a.editData]);return(0,v.jsx)(i.J9,{initialValues:M,validationSchema:m,onSubmit:function(e,a){var t,r=a.setSubmitting;y(!0);var n={materialId:e.materialNo,stockType:null===(t=e.stockType)||void 0===t?void 0:t.value,quantity:e.quantity,warehouseId:e.sourceWareHouse,targetWareHouse:e.targetWareHouse,uomId:e.uomId,availableQuantity:e.availableQuantity,modelType:c.kD.STOCK_ENTRY};console.log(n),(0,s.Fv)(c.vh.ADD_EDIT_DATA,n).then((function(){D(-1),u.Am.push((0,v.jsx)(u.P_,{type:"success",children:"Stock saved successfully!"}))})).catch((function(e){console.error("Error saving stock:",e),u.Am.push((0,v.jsx)(u.P_,{type:"error",message:"Save failed!"}))})).finally((function(){y(!1),r(!1)}))},enableReinitialize:!0,children:function(e){var a,t,r=e.errors,n=e.touched,o=e.values,s=e.setFieldValue,c=e.isSubmitting;return(0,v.jsxs)(i.l0,{children:[(0,v.jsxs)("div",{className:"flex mb-3 justify-between w-3/4",children:[(0,v.jsx)("h3",{children:M.materialNo?"Edit Stock":"Add Stock"}),(0,v.jsxs)("div",{className:"flex",children:[(0,v.jsx)(u.zx,{size:"sm",className:"ltr:mr-3 rtl:ml-3",onClick:function(){return D(-1)},icon:(0,v.jsx)(l.SV5,{}),type:"button",children:"Cancel"}),(0,v.jsx)(u.zx,{size:"sm",variant:"solid",loading:c,icon:(0,v.jsx)(l.JMf,{}),type:"submit",children:M.materialNo?"Update":"Save"})]})]}),(0,v.jsx)(u.Zb,{className:"mt-2.5 w-3/4",children:(0,v.jsxs)(u.Yb,{className:"md:w-full lg:w-1/2",children:[(0,v.jsx)(u.xJ,{label:"Stock Entry Type",invalid:r.stockType&&n.stockType,errorMessage:null===(a=r.stockType)||void 0===a?void 0:a.label,children:(0,v.jsx)(u.Ph,{name:"stockType",options:[{label:"Material Receipt",value:1},{label:"Material Transfer",value:2}],placeholder:"Select Stock Entry Type",value:o.stockType,onChange:function(e){s("stockType",e),s("sourceWareHouse",""),s("targetWareHouse",""),s("availableQuantity","")}})}),(0,v.jsx)(u.xJ,{label:"Material Code",invalid:(null===r||void 0===r?void 0:r.materialNo)&&(null===n||void 0===n?void 0:n.materialNo),errorMessage:null===r||void 0===r?void 0:r.materialNo,children:(0,v.jsx)(u.Ph,{size:"sm",name:"materialNo",placeholder:"Select Material Code",options:x,value:x.find((function(e){return e.value===o.materialNo})),onChange:function(e){console.log("selectedoption",e),s("materialNo",e.value),s("materialName",e.materialName),s("uom",e.uom),s("uomId",e.uomId)}})}),(0,v.jsx)(u.xJ,{label:"Material Name",children:(0,v.jsx)(i.gN,{as:u.II,size:"sm",name:"materialName",value:o.materialName,readOnly:!0})}),(0,v.jsx)(u.xJ,{label:"UOM",children:(0,v.jsx)(i.gN,{as:u.II,size:"sm",name:"uom",value:o.uom,readOnly:!0})}),(0,v.jsx)(u.xJ,{label:"Quantity",invalid:r.quantity&&n.quantity,errorMessage:r.quantity,children:(0,v.jsx)(i.gN,{as:u.II,type:"number",name:"quantity",placeholder:"Add Quantity",value:o.quantity})}),(0,v.jsx)(u.xJ,{label:"Source Warehouse",invalid:r.sourceWareHouse&&n.sourceWareHouse,errorMessage:r.sourceWareHouse,children:(0,v.jsx)(u.Ph,{name:"sourceWareHouse",options:N,placeholder:"Select Source Warehouse",value:N.find((function(e){return e.value===o.sourceWareHouse})),onChange:function(e){s("sourceWareHouse",e.value);N.find((function(a){return a.value===e.value}));var a=q[e.value]||"";s("availableQuantity",a);var t=N.filter((function(a){return a.value!==e.value}));A(t)}})}),2===(null===(t=o.stockType)||void 0===t?void 0:t.value)&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(u.xJ,{label:"Available Quantity",children:(0,v.jsx)(i.gN,{as:u.II,name:"availableQuantity",value:o.availableQuantity,readOnly:!0})}),(0,v.jsx)(u.xJ,{label:"Target Warehouse",invalid:r.targetWareHouse&&n.targetWareHouse,errorMessage:r.targetWareHouse,children:(0,v.jsx)(u.Ph,{name:"targetWareHouse",options:k,placeholder:"Select Target Warehouse",value:k.find((function(e){return e.value===o.targetWareHouse})),onChange:function(e){s("targetWareHouse",e.value)}})})]})]})})]})}})}}}]);
//# sourceMappingURL=5409.d495a740.chunk.js.map