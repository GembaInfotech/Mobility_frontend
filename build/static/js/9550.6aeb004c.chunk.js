"use strict";(self.webpackChunknasp=self.webpackChunknasp||[]).push([[9550],{9494:function(e,n,i){i.d(n,{EY:function(){return s},Fv:function(){return o},ac:function(){return d}});var a=i(74165),l=i(15861),r=i(91181),t=i(14712);function d(e,n){return t.Z.get(e,{params:n}).then((function(e){return null===e||void 0===e?void 0:e.data}))}function o(e,n){return t.Z.post(e,n).then((function(e){return null===e||void 0===e?void 0:e.data}))}function s(e){return u.apply(this,arguments)}function u(){return(u=(0,l.Z)((0,a.Z)().mark((function e(n){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r.Z.fetchData({url:"/search/query",method:"post",data:n}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},9550:function(e,n,i){i.r(n),i.d(n,{default:function(){return S}});var a=i(29439),l=i(72791),r=i(40018),t=i(16146),d=i(92506),o=i(62797),s=i(9494),u=i(11723),c=i(57689),m=i(4942),v=i(1413),p=i(4481),h=i(86368),f=i(77567),x=i(45115),j=i(31414),y=i(80184),Z=[{label:"Sub Admin",name:"sub-user",read:!0,edit:!1,delete:!1},{label:"Patient Management",name:"patient",read:!0,edit:!1,delete:!1},{label:"Physicians",name:"physician",read:!0,edit:!1,delete:!1},{label:"Patient Prescriptions",name:"service-order",read:!0,edit:!1,delete:!1},{label:"Insurance Companies",name:"insurance",read:!0,edit:!1,delete:!1},{label:"Codes (LCode / ICD)",name:"codes",read:!0,edit:!1,delete:!1},{label:"Types Of Devices",name:"types-of-devices",read:!0,edit:!1,delete:!1},{label:"Locations",name:"locations",read:!0,edit:!1,delete:!1},{label:"Stock Entry",name:"stock-entry",read:!0,edit:!1,delete:!1},{label:"Company",name:"Company",read:!1,edit:!1,delete:!1}],b=function(e){e.touched,e.errors;var n=e.values,i=e.setFieldValue,a=function(e,a,l){var r=((null===n||void 0===n?void 0:n.roles)||[]).map((function(n){var i;return(null===n||void 0===n?void 0:n.name)===l?"edit"!==e&&"delete"!==e||!a?(0,v.Z)((0,v.Z)({},n),{},(0,m.Z)({},e,a)):(0,v.Z)((0,v.Z)({},n),{},(i={},(0,m.Z)(i,e,a),(0,m.Z)(i,"read",!0),i)):n}));i("roles",r)};return(0,y.jsxs)("div",{children:[(0,y.jsx)("h4",{className:"my-4",children:"Access Control"}),(0,y.jsxs)(t.iA,{children:[(0,y.jsx)(x.Z,{children:(0,y.jsxs)(j.Z,{children:[(0,y.jsx)(f.Z,{children:"Menu"}),(0,y.jsx)(f.Z,{children:"Read"}),(0,y.jsx)(f.Z,{children:"Add/Edit"}),(0,y.jsx)(f.Z,{children:"Delete"})]})}),(0,y.jsx)(p.Z,{children:null===Z||void 0===Z?void 0:Z.map((function(e,i){var l,r=null===n||void 0===n||null===(l=n.roles)||void 0===l?void 0:l.find((function(n){return(null===n||void 0===n?void 0:n.name)===(null===e||void 0===e?void 0:e.name)}));return(0,y.jsxs)(j.Z,{children:[(0,y.jsxs)(h.Z,{children:[null===e||void 0===e?void 0:e.label," "]}),(0,y.jsx)(h.Z,{children:(0,y.jsx)(t.XZ,{checked:null===r||void 0===r?void 0:r.read,onChange:function(n){return a("read",n,null===e||void 0===e?void 0:e.name)}})}),(0,y.jsx)(h.Z,{children:(0,y.jsx)(t.XZ,{checked:null===r||void 0===r?void 0:r.edit,onChange:function(n){return a("edit",n,null===e||void 0===e?void 0:e.name)}})}),(0,y.jsx)(h.Z,{children:(0,y.jsx)(t.XZ,{checked:null===r||void 0===r?void 0:r.delete,onChange:function(n){return a("delete",n,null===e||void 0===e?void 0:e.name)}})})]},i)}))})]})]})},A=i(60364),C=o.Ry().shape({name:o.Z_().required("Required"),email:o.Z_().email().required("Required")}),g={name:"",email:"",superAdmin:!1,roles:Z},S=function(){var e=(0,l.useRef)(),n=(0,l.useState)(!1),i=(0,a.Z)(n,2),o=i[0],m=i[1],v=(0,l.useState)(),p=(0,a.Z)(v,2),h=p[0],f=p[1],x=(0,l.useState)([]),j=(0,a.Z)(x,2),S=j[0],k=j[1],I=(0,c.UO)().id,N=(0,c.s0)(),D=(0,A.v9)((function(e){var n;return null===e||void 0===e||null===(n=e.auth)||void 0===n?void 0:n.user})).superAdmin;(0,l.useEffect)((function(){(0,s.ac)(u.vh.LIST_DATA,{type:u.kD.COMPANY}).then((function(e){if(e&&e.data&&Array.isArray(e.data.data)){var n=e.data.data.map((function(e){return{label:e.name,value:e._id}}));k(n)}else t.Am.push((0,y.jsx)(t.P_,{type:"error",children:"No Companies found!"}))})).catch((function(e){console.error("Error fetching Companies:",e),t.Am.push((0,y.jsx)(t.P_,{type:"error",children:"Failed to load Companies"}))})),I&&(0,s.ac)(u.vh.LIST_DATA,{type:u.kD.ADMINS,id:I}).then((function(e){var n,i=null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.data;i.superAdmin=!!i.superAdmin,i.roles=i.roles?i.roles:Z,f(i)}))}),[I]);return(0,y.jsx)(r.lG,{children:(0,y.jsx)(d.J9,{innerRef:e,initialValues:h||g,validationSchema:C,onSubmit:function(e,n){var i=e.name,a=e.email,l=e.roles,r=e.superAdmin,d=e.company,o=n.setSubmitting,c=Z.map((function(e){return(null===l||void 0===l?void 0:l.find((function(n){return n.name===e.name})))||e}));m(!0);var v=new FormData;v.append("name",i),v.append("email",a),v.append("superAdmin",r),r||(1===d.length?v.companyId=d:d.forEach((function(e){return v.append("companyId",e)}))),v.append("roles",JSON.stringify(c)),I&&v.append("adminId",I),(0,s.Fv)(u.vh.ADD_EDIT_ADMINS,v).then((function(){N(-1),t.Am.push((0,y.jsx)(t.P_,{type:"success",children:"Sub admin saved!"}))})).catch((function(){o(!1)})).finally((function(){return m(!1)}))},enableReinitialize:!0,children:function(e){var n=e.errors,i=e.touched,a=e.setFieldValue,l=e.isSubmitting,r=e.values;return(0,y.jsxs)(d.l0,{className:"p-5",children:[(0,y.jsxs)("div",{className:"flex mb-3 justify-end w-3/4",children:[(0,y.jsx)(t.zx,{size:"sm",variant:"solid",onClick:function(){return N(-1)},type:"button",children:"Cancel"}),(0,y.jsx)(t.zx,{size:"sm",variant:"solid",style:{marginLeft:"5px"},loading:l,type:"submit",children:I?"Update":"Save"})]}),o&&(0,y.jsx)("div",{className:"flex justify-center",children:(0,y.jsx)(t.$j,{size:"3.25rem"})}),!o&&(0,y.jsx)(t.Zb,{className:"mt-2.5 w-3/4 ",children:(0,y.jsxs)(t.Yb,{children:[(0,y.jsx)(t.xJ,{label:"Name",invalid:(null===n||void 0===n?void 0:n.name)&&(null===i||void 0===i?void 0:i.name),errorMessage:null===n||void 0===n?void 0:n.name,children:(0,y.jsx)(d.gN,{type:"text",autoComplete:"off",name:"name",placeholder:"Enter name ",component:t.II})}),(0,y.jsx)(t.xJ,{label:"Email",invalid:(null===n||void 0===n?void 0:n.email)&&(null===i||void 0===i?void 0:i.email),errorMessage:null===n||void 0===n?void 0:n.email,children:(0,y.jsx)(d.gN,{type:"email",autoComplete:"off",name:"email",placeholder:"Enter Email",component:t.II})}),D&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)("div",{className:"flex justify-between",children:[(0,y.jsx)("p",{className:"font-semibold",children:"Is Super Admin?"}),(0,y.jsx)(t.T5,{name:"superAdmin",checked:null===r||void 0===r?void 0:r.superAdmin,onChange:function(e){console.log("checked",e),a("superAdmin",!e)}})]}),!(null!==r&&void 0!==r&&r.superAdmin)&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(t.xJ,{label:"Company",invalid:n.company&&i.company,errorMessage:n.company,children:(0,y.jsx)(t.Ph,{name:"Company",options:S,placeholder:"Select Company",isMulti:!0,value:S.filter((function(e){var n;return null===(n=r.company)||void 0===n?void 0:n.includes(e.value)})),onChange:function(e){return a("company",e.map((function(e){return e.value})))}})}),(0,y.jsx)(b,{setFieldValue:a,values:r})]})]})]})})]})}})})}}}]);
//# sourceMappingURL=9550.6aeb004c.chunk.js.map