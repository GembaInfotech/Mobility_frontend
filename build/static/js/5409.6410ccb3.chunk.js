"use strict";(self.webpackChunknasp=self.webpackChunknasp||[]).push([[5409],{55409:function(e,t,a){a.r(t);var n=a(29439),i=a(72791),o=a(92506),r=a(62797),l=a(57689),s=a(16146),c=a(78820),u=a(9494),d=a(11723),p=a(52639),y=a(60364),f=a(80184),v=r.Ry().shape({code:r.Z_().required("L Code is required"),stockType:r.Ry().required("Stock Entry Type is required"),quantity:r.Rx().required("Quantity is required").positive("Quantity must be positive").integer("Quantity must be an integer"),location:r.Z_().required("Location is required")}),h={code:"",description:"",stockType:{label:"Material Receipt",value:1},quantity:"",location:"",uom:"",uomId:"",transferLocation:"",transferQuantity:"",companyId:""};t.default=function(e){e.onClose,e.refreshPage;var t,a=(0,l.UO)().id,r=(0,i.useState)(!1),m=(0,n.Z)(r,2),x=m[0],T=(m[1],(0,i.useState)([])),j=(0,n.Z)(T,2),I=j[0],g=j[1],b=(0,i.useState)([]),S=(0,n.Z)(b,2),k=S[0],L=S[1],q=(0,i.useState)(h),A=(0,n.Z)(q,2),C=A[0],_=A[1],Q=(0,i.useState)(!0),D=(0,n.Z)(Q,2),M=D[0],N=D[1],E=(0,i.useState)([]),P=(0,n.Z)(E,2),J=(P[0],P[1],(0,y.v9)((function(e){return e.auth.user})),(0,l.s0)()),R=(0,l.TH)(),Z=localStorage.getItem("selectedHospitalId");(0,i.useEffect)((function(){if((0,u.ac)(d.vh.LIST_DATA,{type:d.kD.CODES,companyId:Z}).then((function(e){if(e&&e.data&&Array.isArray(e.data.data)){var t=e.data.data.filter((function(e){return 1===e.type})).map((function(e){var t,a;return{label:e.code,value:e._id,description:e.description,uom:null===e||void 0===e||null===(t=e.uomId)||void 0===t?void 0:t.name,uomId:null===e||void 0===e||null===(a=e.uomId)||void 0===a?void 0:a._id}}));g(t),N(!1)}else s.Am.push((0,f.jsx)(s.P_,{type:"error",children:"No Materials found!"}))})).catch((function(e){console.error("Error fetching materials:",e),s.Am.push((0,f.jsx)(s.P_,{type:"error",children:"Failed to load Materials"}))})),(0,u.ac)(d.vh.LIST_DATA,{type:d.kD.LOCATIONS,companyId:Z}).then((function(e){if(e&&e.data&&Array.isArray(e.data.data)){var t=e.data.data.map((function(e){return{label:e.name,value:e._id}}));L(t)}else s.Am.push((0,f.jsx)(s.P_,{type:"error",children:"No Warehouses found!"}))})).catch((function(e){console.error("Error fetching warehouses:",e),s.Am.push((0,f.jsx)(s.P_,{type:"error",children:"Failed to load Warehouses"}))})),a){var e,t,n,i,o=null===(e=R.state)||void 0===e?void 0:e.editData;_({code:(null===o||void 0===o||null===(t=o.lcodeId)||void 0===t?void 0:t._id)||"",description:(null===(n=o.lcodeId)||void 0===n?void 0:n.description)||"",stockType:{label:"Material Receipt",value:1},quantity:o.quantity||"",location:(null===(i=o.locationId)||void 0===i?void 0:i._id)||"",modelType:d.kD.STOCK_ENTRY})}}),[a,null===(t=R.state)||void 0===t?void 0:t.editData]);return(0,f.jsx)(o.J9,{initialValues:C,validationSchema:v,onSubmit:function(e,t){var n,i=t.setSubmitting,o={lcodeId:e.code,stockType:null===(n=e.stockType)||void 0===n?void 0:n.value,quantity:e.quantity,locationId:e.location,uomId:e.uomId,transferLocation:e.transferLocation,transferQuantity:e.transferQuantity,modelType:d.kD.STOCK_ENTRY,companyId:Z};a&&(o.id=a),(0,u.Fv)(d.vh.ADD_EDIT_DATA,o).then((function(e){s.Am.push((0,f.jsx)(s.P_,{type:"success",children:a?p.D5:p.Te})),J("/app/inventory/stockEntry")})).catch((function(e){i(!1)})).finally((function(){i(!1)}))},enableReinitialize:!0,children:function(e){var t=e.errors,a=e.touched,n=e.values,i=e.setFieldValue,r=e.isSubmitting;return(0,f.jsxs)(o.l0,{children:[(0,f.jsxs)("div",{className:"flex mb-3 justify-between w-3/4",children:[(0,f.jsx)("h3",{children:C.code?"Edit Stock":"Add Stock"}),(0,f.jsxs)("div",{className:"flex",children:[(0,f.jsx)(s.zx,{size:"sm",className:"ltr:mr-3 rtl:ml-3",onClick:function(){return J(-1)},icon:(0,f.jsx)(c.SV5,{}),type:"button",children:"Cancel"}),(0,f.jsx)(s.zx,{size:"sm",variant:"solid",loading:r||x,icon:(0,f.jsx)(c.JMf,{}),type:"submit",children:C.code?"Update":"Save"})]})]}),(0,f.jsx)(s.Zb,{className:"mt-2.5 w-3/4",children:(0,f.jsxs)(s.Yb,{className:"md:w-full lg:w-1/2",children:[(0,f.jsx)(s.xJ,{label:"Stock Entry Type",invalid:t.stockType&&a.stockType,errorMessage:t.stockType,children:(0,f.jsx)(s.Ph,{name:"stockType",options:[{label:"Material Receipt",value:1},{label:"Material Transfer",value:2}],placeholder:"Select Stock Type",value:n.stockType,onChange:function(e){return i("stockType",e)}})}),(0,f.jsx)(s.xJ,{label:"Location",invalid:t.location&&a.location,errorMessage:t.location,children:(0,f.jsx)(s.Ph,{name:"location",options:k,placeholder:"Select Location",value:k.find((function(e){return e.value===n.location})),onChange:function(e){return i("location",e.value)}})}),(0,f.jsx)(s.xJ,{label:"LCode",invalid:t.code&&a.code,errorMessage:t.code,children:M?(0,f.jsx)(s.II,{size:"sm",value:"Loading...",readOnly:!0}):(0,f.jsx)(s.Ph,{size:"sm",name:"code",placeholder:"Select LCode",options:I,value:I.find((function(e){return e.value===n.code}))||null,onChange:function(e){i("code",e.value),i("description",e.description),i("uom",e.uom),i("uomId",e.uomId)}})}),(0,f.jsx)(s.xJ,{label:"Description",children:(0,f.jsx)(o.gN,{as:s.II,size:"sm",name:"description",value:n.description,readOnly:!0})}),(0,f.jsx)(s.xJ,{label:"Quantity",invalid:t.quantity&&a.quantity,errorMessage:t.quantity,children:(0,f.jsx)(o.gN,{as:s.II,type:"number",name:"quantity",placeholder:"Add Quantity",value:n.quantity,onChange:function(e){return i("quantity",e.target.value)}})}),2===n.stockType.value&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(s.xJ,{label:"Transfer Location",invalid:t.transferLocation&&a.transferLocation,errorMessage:t.transferLocation,children:(0,f.jsx)(s.Ph,{name:"transferLocation",options:k,placeholder:"Select Transfer Location",value:k.find((function(e){return e.value===n.transferLocation})),onChange:function(e){return i("transferLocation",e.value)}})}),(0,f.jsx)(s.xJ,{label:"Transfer Quantity",invalid:t.transferQuantity&&a.transferQuantity,errorMessage:t.transferQuantity,children:(0,f.jsx)(o.gN,{as:s.II,type:"number",name:"transferQuantity",placeholder:"Enter Transfer Quantity",value:n.transferQuantity,onChange:function(e){return i("transferQuantity",e.target.value)}})})]})]})})]})}})}}}]);
//# sourceMappingURL=5409.6410ccb3.chunk.js.map