"use strict";(self.webpackChunknasp=self.webpackChunknasp||[]).push([[5409],{9494:function(e,t,n){n.d(t,{EY:function(){return u},Fv:function(){return s},ac:function(){return l}});var a=n(74165),i=n(15861),r=n(91181),o=n(14712);function l(e,t){return o.Z.get(e,{params:t}).then((function(e){return null===e||void 0===e?void 0:e.data}))}function s(e,t){return o.Z.post(e,t).then((function(e){return null===e||void 0===e?void 0:e.data}))}function u(e){return c.apply(this,arguments)}function c(){return(c=(0,i.Z)((0,a.Z)().mark((function e(t){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r.Z.fetchData({url:"/search/query",method:"post",data:t}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},55409:function(e,t,n){n.r(t);var a=n(29439),i=n(72791),r=n(92506),o=n(62797),l=n(57689),s=n(16146),u=n(78820),c=n(9494),d=n(11723),f=n(52639),p=n(60364),v=n(80184),y=o.Ry().shape({code:o.Z_().required("L Code is required"),stockType:o.Ry().required("Stock Entry Type is required"),quantity:o.Rx().required("Quantity is required").positive("Quantity must be positive").integer("Quantity must be an integer"),location:o.Z_().required("Location is required")}),h={code:"",description:"",stockType:{label:"Material Receipt",value:1},quantity:"",location:"",uom:"",uomId:"",transferLocation:"",transferQuantity:"",companyId:""};t.default=function(e){e.onClose,e.refreshPage;var t,n=(0,l.UO)().id,o=(0,i.useState)(!1),m=(0,a.Z)(o,2),x=m[0],T=(m[1],(0,i.useState)([])),j=(0,a.Z)(T,2),g=j[0],I=j[1],b=(0,i.useState)([]),k=(0,a.Z)(b,2),S=k[0],q=k[1],L=(0,i.useState)(h),A=(0,a.Z)(L,2),C=A[0],_=A[1],D=(0,i.useState)(!0),Q=(0,a.Z)(D,2),Z=Q[0],E=Q[1],M=(0,i.useState)([]),N=(0,a.Z)(M,2),w=(N[0],N[1],(0,p.v9)((function(e){return e.auth.user})),(0,l.s0)()),P=(0,l.TH)(),J=localStorage.getItem("selectedHospitalId");(0,i.useEffect)((function(){if((0,c.ac)(d.vh.LIST_DATA,{type:d.kD.CODES,companyId:J}).then((function(e){if(e&&e.data&&Array.isArray(e.data.data)){var t=e.data.data.filter((function(e){return 1===e.type})).map((function(e){var t,n;return{label:e.code,value:e._id,description:e.description,uom:null===e||void 0===e||null===(t=e.uomId)||void 0===t?void 0:t.name,uomId:null===e||void 0===e||null===(n=e.uomId)||void 0===n?void 0:n._id}}));I(t),E(!1)}else s.Am.push((0,v.jsx)(s.P_,{type:"error",children:"No Materials found!"}))})).catch((function(e){console.error("Error fetching materials:",e),s.Am.push((0,v.jsx)(s.P_,{type:"error",children:"Failed to load Materials"}))})),(0,c.ac)(d.vh.LIST_DATA,{type:d.kD.LOCATIONS,companyId:J}).then((function(e){if(e&&e.data&&Array.isArray(e.data.data)){var t=e.data.data.map((function(e){return{label:e.name,value:e._id}}));q(t)}else s.Am.push((0,v.jsx)(s.P_,{type:"error",children:"No Warehouses found!"}))})).catch((function(e){console.error("Error fetching warehouses:",e),s.Am.push((0,v.jsx)(s.P_,{type:"error",children:"Failed to load Warehouses"}))})),n){var e,t,a,i,r=null===(e=P.state)||void 0===e?void 0:e.editData;_({code:(null===r||void 0===r||null===(t=r.lcodeId)||void 0===t?void 0:t._id)||"",description:(null===(a=r.lcodeId)||void 0===a?void 0:a.description)||"",stockType:{label:"Material Receipt",value:1},quantity:r.quantity||"",location:(null===(i=r.locationId)||void 0===i?void 0:i._id)||"",modelType:d.kD.STOCK_ENTRY})}}),[n,null===(t=P.state)||void 0===t?void 0:t.editData]);return(0,v.jsx)(r.J9,{initialValues:C,validationSchema:y,onSubmit:function(e,t){var a,i=t.setSubmitting,r={lcodeId:e.code,stockType:null===(a=e.stockType)||void 0===a?void 0:a.value,quantity:e.quantity,locationId:e.location,uomId:e.uomId,transferLocation:e.transferLocation,transferQuantity:e.transferQuantity,modelType:d.kD.STOCK_ENTRY,companyId:J};n&&(r.id=n),(0,c.Fv)(d.vh.ADD_EDIT_DATA,r).then((function(e){s.Am.push((0,v.jsx)(s.P_,{type:"success",children:n?f.D5:f.Te})),w("/app/inventory/stockEntry")})).catch((function(e){i(!1)})).finally((function(){i(!1)}))},enableReinitialize:!0,children:function(e){var t=e.errors,n=e.touched,a=e.values,i=e.setFieldValue,o=e.isSubmitting;return(0,v.jsxs)(r.l0,{children:[(0,v.jsxs)("div",{className:"flex mb-3 justify-between w-3/4",children:[(0,v.jsx)("h3",{children:C.code?"Edit Stock":"Add Stock"}),(0,v.jsxs)("div",{className:"flex",children:[(0,v.jsx)(s.zx,{size:"sm",className:"ltr:mr-3 rtl:ml-3",onClick:function(){return w(-1)},icon:(0,v.jsx)(u.SV5,{}),type:"button",children:"Cancel"}),(0,v.jsx)(s.zx,{size:"sm",variant:"solid",loading:o||x,icon:(0,v.jsx)(u.JMf,{}),type:"submit",children:C.code?"Update":"Save"})]})]}),(0,v.jsx)(s.Zb,{className:"mt-2.5 w-3/4",children:(0,v.jsxs)(s.Yb,{className:"md:w-full lg:w-1/2",children:[(0,v.jsx)(s.xJ,{label:"Stock Entry Type",invalid:t.stockType&&n.stockType,errorMessage:t.stockType,children:(0,v.jsx)(s.Ph,{name:"stockType",options:[{label:"Material Receipt",value:1},{label:"Material Transfer",value:2}],placeholder:"Select Stock Type",value:a.stockType,onChange:function(e){return i("stockType",e)}})}),(0,v.jsx)(s.xJ,{label:"Location",invalid:t.location&&n.location,errorMessage:t.location,children:(0,v.jsx)(s.Ph,{name:"location",options:S,placeholder:"Select Location",value:S.find((function(e){return e.value===a.location})),onChange:function(e){return i("location",e.value)}})}),(0,v.jsx)(s.xJ,{label:"LCode",invalid:t.code&&n.code,errorMessage:t.code,children:Z?(0,v.jsx)(s.II,{size:"sm",value:"Loading...",readOnly:!0}):(0,v.jsx)(s.Ph,{size:"sm",name:"code",placeholder:"Select LCode",options:g,value:g.find((function(e){return e.value===a.code}))||null,onChange:function(e){i("code",e.value),i("description",e.description),i("uom",e.uom),i("uomId",e.uomId)}})}),(0,v.jsx)(s.xJ,{label:"Description",children:(0,v.jsx)(r.gN,{as:s.II,size:"sm",name:"description",value:a.description,readOnly:!0})}),(0,v.jsx)(s.xJ,{label:"Quantity",invalid:t.quantity&&n.quantity,errorMessage:t.quantity,children:(0,v.jsx)(r.gN,{as:s.II,type:"number",name:"quantity",placeholder:"Add Quantity",value:a.quantity,onChange:function(e){return i("quantity",e.target.value)}})}),2===a.stockType.value&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(s.xJ,{label:"Transfer Location",invalid:t.transferLocation&&n.transferLocation,errorMessage:t.transferLocation,children:(0,v.jsx)(s.Ph,{name:"transferLocation",options:S,placeholder:"Select Transfer Location",value:S.find((function(e){return e.value===a.transferLocation})),onChange:function(e){return i("transferLocation",e.value)}})}),(0,v.jsx)(s.xJ,{label:"Transfer Quantity",invalid:t.transferQuantity&&n.transferQuantity,errorMessage:t.transferQuantity,children:(0,v.jsx)(r.gN,{as:s.II,type:"number",name:"transferQuantity",placeholder:"Enter Transfer Quantity",value:a.transferQuantity,onChange:function(e){return i("transferQuantity",e.target.value)}})})]})]})})]})}})}}}]);
//# sourceMappingURL=5409.293f4db8.chunk.js.map