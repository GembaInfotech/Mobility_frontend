"use strict";(self.webpackChunknasp=self.webpackChunknasp||[]).push([[5409],{9494:function(e,t,i){i.d(t,{EY:function(){return d},Fv:function(){return u},ac:function(){return l}});var n=i(74165),a=i(15861),o=i(91181),r=i(14712);function l(e,t){return r.Z.get(e,{params:t}).then((function(e){return null===e||void 0===e?void 0:e.data}))}function u(e,t){return r.Z.post(e,t).then((function(e){return null===e||void 0===e?void 0:e.data}))}function d(e){return s.apply(this,arguments)}function s(){return(s=(0,a.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",o.Z.fetchData({url:"/search/query",method:"post",data:t}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},55409:function(e,t,i){i.r(t);var n=i(29439),a=i(72791),o=i(92506),r=i(62797),l=i(57689),u=i(16146),d=i(78820),s=i(9494),c=i(11723),v=i(52639),p=i(80184),h=r.Ry().shape({code:r.Z_().required("L Code is required"),stockType:r.Ry().required("Stock Entry Type is required"),quantity:r.Rx().required("Quantity is required").positive("Quantity must be positive").integer("Quantity must be an integer"),location:r.Z_().required("Location is required")}),f={code:"",description:"",stockType:{label:"Material Receipt",value:1},quantity:"",location:"",uom:"",uomId:""};t.default=function(e){e.onClose,e.refreshPage;var t,i=(0,l.UO)().id,r=(0,a.useState)(!1),m=(0,n.Z)(r,2),y=m[0],x=(m[1],(0,a.useState)([])),j=(0,n.Z)(x,2),b=j[0],I=j[1],S=(0,a.useState)([]),T=(0,n.Z)(S,2),k=T[0],q=T[1],A=(0,a.useState)(f),_=(0,n.Z)(A,2),g=_[0],D=_[1],C=(0,a.useState)(!0),Z=(0,n.Z)(C,2),E=Z[0],N=Z[1],L=(0,l.s0)(),w=(0,l.TH)();(0,a.useEffect)((function(){if((0,s.ac)(c.vh.LIST_DATA,{type:c.kD.CODES}).then((function(e){if(e&&e.data&&Array.isArray(e.data.data)){var t=e.data.data.filter((function(e){return 1===e.type})).map((function(e){var t,i;return{label:e.code,value:e._id,description:e.description,uom:null===e||void 0===e||null===(t=e.uomId)||void 0===t?void 0:t.name,uomId:null===e||void 0===e||null===(i=e.uomId)||void 0===i?void 0:i._id}}));I(t),N(!1)}else u.Am.push((0,p.jsx)(u.P_,{type:"error",children:"No Materials found!"}))})).catch((function(e){console.error("Error fetching materials:",e),u.Am.push((0,p.jsx)(u.P_,{type:"error",children:"Failed to load Materials"}))})),(0,s.ac)(c.vh.LIST_DATA,{type:c.kD.LOCATIONS}).then((function(e){if(e&&e.data&&Array.isArray(e.data.data)){var t=e.data.data.map((function(e){return{label:e.name,value:e._id}}));q(t)}else u.Am.push((0,p.jsx)(u.P_,{type:"error",children:"No Warehouses found!"}))})).catch((function(e){console.error("Error fetching warehouses:",e),u.Am.push((0,p.jsx)(u.P_,{type:"error",children:"Failed to load Warehouses"}))})),i){var e,t,n,a,o=null===(e=w.state)||void 0===e?void 0:e.editData;D({code:(null===o||void 0===o||null===(t=o.lcodeId)||void 0===t?void 0:t._id)||"",description:(null===(n=o.lcodeId)||void 0===n?void 0:n.description)||"",stockType:{label:"Material Receipt",value:1},quantity:o.quantity||"",location:(null===(a=o.locationId)||void 0===a?void 0:a._id)||"",modelType:c.kD.STOCK_ENTRY})}}),[i,null===(t=w.state)||void 0===t?void 0:t.editData]);return(0,p.jsx)(o.J9,{initialValues:g,validationSchema:h,onSubmit:function(e,t){var n,a=t.setSubmitting,o={lcodeId:e.code,stockType:null===(n=e.stockType)||void 0===n?void 0:n.value,quantity:e.quantity,locationId:e.location,uomId:e.uomId,modelType:c.kD.STOCK_ENTRY};i&&(o.id=i),(0,s.Fv)(c.vh.ADD_EDIT_DATA,o).then((function(e){u.Am.push((0,p.jsx)(u.P_,{type:"success",children:i?v.D5:v.Te})),L("/app/inventory/stockEntry")})).catch((function(e){u.Am.push((0,p.jsx)(u.P_,{type:"error",children:e}))})).finally((function(){a(!1)}))},enableReinitialize:!0,children:function(e){var t=e.errors,i=e.touched,n=e.values,a=e.setFieldValue,r=e.isSubmitting;return(0,p.jsxs)(o.l0,{children:[(0,p.jsxs)("div",{className:"flex mb-3 justify-between w-3/4",children:[(0,p.jsx)("h3",{children:g.code?"Edit Stock":"Add Stock"}),(0,p.jsxs)("div",{className:"flex",children:[(0,p.jsx)(u.zx,{size:"sm",className:"ltr:mr-3 rtl:ml-3",onClick:function(){return L(-1)},icon:(0,p.jsx)(d.SV5,{}),type:"button",children:"Cancel"}),(0,p.jsx)(u.zx,{size:"sm",variant:"solid",loading:r||y,icon:(0,p.jsx)(d.JMf,{}),type:"submit",children:g.code?"Update":"Save"})]})]}),(0,p.jsx)(u.Zb,{className:"mt-2.5 w-3/4",children:(0,p.jsxs)(u.Yb,{className:"md:w-full lg:w-1/2",children:[(0,p.jsx)(u.xJ,{label:"Stock Entry Type",children:(0,p.jsx)(u.II,{value:"Material Receipt",readOnly:!0,size:"sm"})}),(0,p.jsx)(u.xJ,{label:"Location",invalid:t.location&&i.location,errorMessage:t.location,children:(0,p.jsx)(u.Ph,{name:"Location",options:k,placeholder:"Select Location",value:k.find((function(e){return e.value===n.location})),onChange:function(e){return a("location",e.value)}})}),(0,p.jsx)(u.xJ,{label:"LCode",invalid:(null===t||void 0===t?void 0:t.code)&&(null===i||void 0===i?void 0:i.code),errorMessage:null===t||void 0===t?void 0:t.code,children:E?(0,p.jsx)(u.II,{size:"sm",value:"Loading...",readOnly:!0}):(0,p.jsx)(u.Ph,{size:"sm",name:"lcode",placeholder:"Select LCode",options:b,value:b.find((function(e){return e.value===n.code}))||null,onChange:function(e){a("code",e.value),a("description",e.description),a("uom",e.uom),a("uomId",e.uomId)}})}),(0,p.jsx)(u.xJ,{label:"Description",children:(0,p.jsx)(o.gN,{as:u.II,size:"sm",name:"description",value:n.description,readOnly:!0})}),(0,p.jsx)(u.xJ,{label:"Quantity",invalid:t.quantity&&i.quantity,errorMessage:t.quantity,children:(0,p.jsx)(o.gN,{as:u.II,type:"number",name:"quantity",placeholder:"Add Quantity",value:n.quantity})})]})})]})}})}}}]);
//# sourceMappingURL=5409.bb7a56d2.chunk.js.map